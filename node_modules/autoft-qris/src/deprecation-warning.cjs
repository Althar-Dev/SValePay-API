const path = require('path');

class DeprecationWarning {
    static checkNodeVersion() {
        const nodeVersion = process.version;
        const currentVersion = nodeVersion.slice(1);
        const targetVersion = '21.7.3';
        
        if (currentVersion !== targetVersion) {
            console.log('\n' + '='.repeat(60));
            console.log('âš ï¸  NODE.JS VERSION WARNING!');
            console.log('='.repeat(60));
            console.log(`ğŸ”´ Node.js ${nodeVersion} detected`);
            console.log('âŒ Chalk package hanya support Node.js 21.7.3');
            console.log('ğŸ“‹ Solusi:');
            console.log('   â€¢ Install Node.js 21.7.3 secara spesifik');
            console.log('   â€¢ Versi lain akan menyebabkan chalk error');
            console.log(`ğŸ’¡ Required Node.js version: ${targetVersion}`);
            console.log('='.repeat(60) + '\n');
            return false;
        }
        return true;
    }

    static showUpdateNotification() {
        try {
            const chalk = require('chalk');
            const packageJsonPath = path.resolve(__dirname, '../package.json');
            const currentVersion = require(packageJsonPath).version;
            
            console.log('\n' + '='.repeat(60));
            console.log(chalk.yellow.bold('ğŸš€ UPDATE TERSEDIA!'));
            console.log('='.repeat(60));
            console.log(chalk.cyan('ğŸ“¦ Package: autoft-qris'));
            console.log(chalk.green(`âœ¨ Versi Terbaru: v${currentVersion}`));
            console.log(chalk.blue('ğŸ¨ Fitur Baru:'));
            console.log(chalk.white('   â€¢ 2 Tema QRIS (Default & Meta Style)'));
            console.log(chalk.white('   â€¢ ESM & CommonJS Support'));
            console.log(chalk.white('   â€¢ Perbaikan performa'));
            console.log(chalk.white('   â€¢ API yang lebih bersih'));
            console.log(chalk.yellow('\nğŸ’¡ Untuk update:'));
            console.log(chalk.white('   npm update autoft-qris'));
            console.log(chalk.gray('\nğŸ“– Dokumentasi lengkap:'));
            console.log(chalk.blue('   https://github.com/AutoFTbot/Qris-OrderKuota'));
            console.log(chalk.magenta('\nğŸ‘¨â€ğŸ’» Original Author: AutoFTbot'));
            console.log(chalk.green('ğŸ¤ Contributor: AlfiDev'));
            console.log('='.repeat(60) + '\n');
        } catch (error) {
            console.log('\n' + '='.repeat(60));
            console.log('ğŸš€ UPDATE TERSEDIA!');
            console.log('='.repeat(60));
            console.log('ğŸ“¦ Package: autoft-qris');
            console.log('âœ¨ Versi Terbaru dengan fitur baru!');
            console.log('ğŸ¨ Fitur Baru:');
            console.log('   â€¢ 2 Tema QRIS (Default & Meta Style)');
            console.log('   â€¢ ESM & CommonJS Support');
            console.log('   â€¢ Perbaikan performa');
            console.log('   â€¢ API yang lebih bersih');
            console.log('\nğŸ’¡ Untuk update:');
            console.log('   npm update autoft-qris');
            console.log('\nğŸ“– Dokumentasi lengkap:');
            console.log('   https://github.com/AutoFTbot/Qris-OrderKuota');
            console.log('\nğŸ‘¨â€ğŸ’» Original Author: AutoFTbot');
            console.log('ğŸ¤ Contributor: AlfiDev');
            console.log('='.repeat(60) + '\n');
        }
    }

    static checkAndShowWarning() {
        try {
            if (process.env.NODE_ENV === 'production') return;
            
            if (!this.checkNodeVersion()) return;
            
            this.showUpdateNotification();
        } catch (error) {
        }
    }
}

module.exports = DeprecationWarning;